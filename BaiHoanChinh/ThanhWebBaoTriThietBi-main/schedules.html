<!DOCTYPE html>
<html lang="vi" ng-app="AppQuanLyBaoTri">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>L·ªãch B·∫£o tr√¨ - H·ªá th·ªëng B·∫£o tr√¨</title>

  <!-- Tailwind & AngularJS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>

  <style>
    .nav-link {
      display: flex; align-items: center; gap: 8px;
      padding: 10px 16px; border-radius: 8px;
      font-weight: 500; color: #374151;
      transition: all 0.2s ease;
    }
    .nav-link:hover { background-color: #f3f4f6; }
    .nav-link.active {
      background-color: #e0f2fe; color: #2563eb; font-weight: 600;
      box-shadow: inset 0 0 0 1px #bfdbfe;
    }
    .modal {
      display: none; position: fixed; inset: 0;
      z-index: 50; background: rgba(0, 0, 0, 0.5);
      justify-content: center; align-items: center;
    }
    .modal.show { display: flex; }
    .modal-content {
      background: white; border-radius: 0.75rem;
      padding: 1.5rem; width: 90%; max-width: 600px;
      max-height: 90vh; overflow-y: auto;
    }
  </style>
</head>

<body ng-controller="LichBaoTriCtrl" class="bg-gray-50">

  <div class="flex h-screen">
    <!-- Sidebar -->
    <aside class="w-64 bg-white border-r border-gray-200 flex flex-col">
      <div class="p-6 border-b border-gray-200">
        <h1 class="text-2xl font-bold text-blue-600">H·ªá th·ªëng B·∫£o tr√¨</h1>
      </div>

      <nav class="flex-1 p-4 overflow-y-auto space-y-1">
        <a href="dashboard.html" class="nav-link">üìä T·ªïng quan</a>
        <a href="assets.html" class="nav-link">üè¢ T√†i s·∫£n</a>
        <a href="customers.html" class="nav-link">üë• Kh√°ch h√†ng</a>
        <a href="warranties.html" class="nav-link">üõ°Ô∏è B·∫£o h√†nh</a>
        <a href="work-orders.html" class="nav-link">üìã Phi·∫øu c√¥ng vi·ªác</a>
        <a href="schedules.html" class="nav-link active">üìÖ L·ªãch b·∫£o tr√¨</a>
        <a href="incidents.html" class="nav-link">‚ö†Ô∏è S·ª± c·ªë</a>
        <a href="inventory.html" class="nav-link">üîß Kho linh ki·ªán</a>
        <a href="warehouse.html" class="nav-link">üì¶ Phi·∫øu kho</a>
        <a href="employees.html" class="nav-link">üë®‚Äçüíº Nh√¢n vi√™n</a>
        <a href="roles.html" class="nav-link">üîê T√†i kho·∫£n</a>
        <a href="checklists.html" class="nav-link">‚úÖ Checklist</a>
        <a href="logs.html" class="nav-link">üßæ Nh·∫≠t k√Ω h·ªá th·ªëng</a>
      </nav>

      <div class="p-4 border-t border-gray-200">
        <button ng-click="logout()" class="w-full bg-red-500 text-white py-2 px-4 rounded hover:bg-red-600">
          ƒêƒÉng xu·∫•t
        </button>
      </div>
    </aside>

    <!-- Main -->
    <main class="flex-1 overflow-y-auto">
      <div class="p-8">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-3xl font-bold text-gray-800">Qu·∫£n l√Ω L·ªãch B·∫£o tr√¨</h2>
          <button ng-click="OpenModal()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
            + Th√™m l·ªãch b·∫£o tr√¨
          </button>
        </div>

        <!-- Table -->
        <div class="bg-white rounded-lg shadow overflow-hidden">
          <table class="w-full">
            <thead class="bg-gray-50 border-b border-gray-200">
              <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">M√£ l·ªãch</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">T√†i s·∫£n</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nh√¢n vi√™n</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">T·∫ßn su·∫•t</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Ng√†y k·∫ø ti·∫øp</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Hi·ªáu l·ª±c</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Thao t√°c</th>
              </tr>
            </thead>
            <tbody>

              <tr ng-repeat="l in listLichBaoTri" class="hover:bg-gray-50">
                <td class="px-6 py-4 text-sm">{{l.MaLich}}</td>
                <td class="px-6 py-4 text-sm">{{l.tenTaiSan}}</td>
                <td class="px-6 py-4 text-sm">{{l.tenNhanVien}}</td>

                <td class="px-6 py-4 text-sm">{{l.TanSuat}} ({{l.SoNgayLapLai}} ng√†y)</td>

                <td class="px-6 py-4 text-sm">{{l.NgayKeTiep | date:'dd/MM/yyyy'}}</td>

                <td class="px-6 py-4 text-sm">
                  <span ng-class="{'text-green-600': l.HieuLuc, 'text-gray-400': !l.HieuLuc}">
                    {{l.HieuLuc ? 'C√≤n hi·ªáu l·ª±c' : 'Ng·ª´ng'}}
                  </span>
                </td>

                <td class="px-6 py-4 text-blue-600">
                  <button ng-click="EditLich(l)" class="hover:underline">S·ª≠a</button> |
                  <button ng-click="DeleteLich(l.MaLich)" class="hover:underline text-red-600">X√≥a</button>
                </td>
              </tr>

              <tr ng-if="!listLichBaoTri.length">
                <td colspan="7" class="text-center py-6 text-gray-400">Kh√¥ng c√≥ d·ªØ li·ªáu</td>
              </tr>

            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>

  <!-- Modal -->
  <div class="modal" ng-class="{'show': showModal}">
    <div class="modal-content">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold">{{modalTitle}}</h3>
        <button ng-click="CloseModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
      </div>

      <form ng-submit="SaveLich()">
        <div class="grid grid-cols-2 gap-4">

          <div>
            <label class="block text-sm font-medium mb-1">T√†i s·∫£n</label>
            <select ng-model="lich.MaTaiSan"
                    ng-options="t.maTaiSan as t.tenTaiSan for t in listTaiSan"
                    class="border rounded px-3 py-2 w-full"></select>
          </div>

          <div>
            <label class="block text-sm font-medium mb-1">Nh√¢n vi√™n</label>
            <select ng-model="lich.MaNV"
                    ng-options="n.maNV as n.hoTen for n in listNhanVien"
                    class="border rounded px-3 py-2 w-full">
              <option value="">-- Kh√¥ng g√°n --</option>
            </select>
          </div>

          <div>
            <label class="block text-sm font-medium mb-1">T·∫ßn su·∫•t</label>
            <input ng-model="lich.TanSuat" class="border rounded px-3 py-2 w-full" />
          </div>

          <div>
            <label class="block text-sm font-medium mb-1">S·ªë ng√†y l·∫∑p l·∫°i</label>
            <input type="number" ng-model="lich.SoNgayLapLai" class="border rounded px-3 py-2 w-full" />
          </div>

          <div>
            <label class="block text-sm font-medium mb-1">Ng√†y k·∫ø ti·∫øp</label>
            <input type="date" ng-model="lich.NgayKeTiep" class="border rounded px-3 py-2 w-full" />
          </div>

          <div>
            <label class="block text-sm font-medium mb-1">Hi·ªáu l·ª±c</label>
            <select ng-model="lich.HieuLuc" class="border rounded px-3 py-2 w-full">
              <option value="true">C√≤n hi·ªáu l·ª±c</option>
              <option value="false">Ng·ª´ng</option>
            </select>
          </div>

        </div>

        <div class="mt-6 flex justify-end gap-2">
          <button type="button" ng-click="CloseModal()" class="px-4 py-2 border rounded hover:bg-gray-100">H·ªßy</button>
          <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">L∆∞u</button>
        </div>

      </form>
    </div>
  </div>

  <!-- Script -->
  <script src="schedules.js"></script>
</body>
</html>
